service:
  name: redis-grain-demo
  type: stateful

deploy:
  target: kubernetes
  namespace: toskamesh

workloads:
  - name: redis-grain-silo
    type: stateful
    manifests:
      - k8s/redis-grain-demo/service.yaml
      - k8s/redis-grain-demo/deployment.yaml
    image:
      repository: redis-grain-silo
      tag: local
      registry: localhost:5000
    build:
      context: .
      dockerfile: Dockerfile.silo

  - name: redis-grain-api
    type: stateless
    manifests:
      - k8s/redis-grain-demo/service.yaml
      - k8s/redis-grain-demo/deployment.yaml
    image:
      repository: redis-grain-api
      tag: local
      registry: localhost:5000
    build:
      context: .
      dockerfile: Dockerfile.api
